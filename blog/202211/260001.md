---
title: 论文《ConvLSTM: A Machine Learning Approach for Precipitation Nowcasting》阅读
---

# 论文《ConvLSTM: A Machine Learning Approach for Precipitation Nowcasting》阅读

<script type="text/javascript" src="/include/head.js"></script>

本文提出了ConvLSTM结构（全称Convolutional LSTM）和Encoding-Forecasting框架，用于端到端短临降水预报问题。短临降水预报问题是一个典型的时空序列预测问题，输入和输出都是时空序列。

## 背景

### 短临降水预报问题

短临降水预报问题可以分为两类：基于数值天气预报的方法，和基于雷达回波外推的方法。基于数值天气预报的方法需要对大气模型物理方程进行复杂精细的建模，难度较高，SOTA方案一般采用基于雷达回波外推的方法。

短临降水预报问题可以归结为时空序列预测问题，输入为过去的雷达图序列，输出为固定数量（通常大于1）的未来的雷达图序列。假设雷达图大小为$M \times N$的网格，每个网格内有$P$个随时间变化的测量值，即每张雷达图是一个$M \times N \times P$的张量。此处称之为时空序列预测问题，因为预测目标是包含时间和空间结构的序列。

### 序列建模的长短期记忆网络

本文中的LSTM是一种加入了窥视孔连接的Peephole LSTM，具体来说是将$c_{t-1}$加入到输入门$i_t$、遗忘门$f_t$的输入中，$c_t$加入到输出门$o_t$的输入中，公式如下：

$$i_t = \sigma (W_{xi}x_t + W_{hi}h_{t−1} + W_{ci} \circ c_{t−1} + b_i)$$
$$f_t = \sigma (W_{xf}x_t + W_{hf}h_{t−1} + W_{cf} \circ c_{t−1} + b_f)$$
$$c_t = f_t \circ c_{t−1} + i_t \circ tanh(W_{xc}x_t + W_{hc}h_{t−1} + b_c)$$
$$o_t = \sigma ( W_{xo}x_t + W_{ho}h_{t−1} + W_{co} \circ c_t + b_o)$$
$$h_t = o_t \circ tanh(c_t)$$

## 模型结构

### ConvLSTM

$$i_t = \sigma (W_{xi} \ast \mathcal{X}_t + W_{hi} \ast \mathcal{H}_{t−1} + W_{ci} \circ \mathcal{C}_{t−1} + b_i)$$
$$f_t = \sigma (W_{xf} \ast \mathcal{X}_t + W_{hf} \ast \mathcal{H}_{t−1} + W_{cf} \circ \mathcal{C}_{t−1} + b_f)$$
$$\mathcal{C}_t = f_t \circ \mathcal{C}_{t−1} + i_t \circ tanh(W_{xc} \ast \mathcal{X}_t + W_{hc} \ast \mathcal{H}_{t−1} + b_c)$$
$$o_t = \sigma (W_{xo} \ast \mathcal{X}_t + W_{ho} \ast \mathcal{H}_{t−1} + W_{co} \circ \mathcal{C}_t + b_o)$$
$$\mathcal{H}_t = o_t \circ tanh(\mathcal{C}_t)$$

### Encoding-Forecasting框架

---

<script type="text/javascript" src="/include/tail.js"></script>